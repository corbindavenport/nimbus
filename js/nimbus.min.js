$(document).ready(function(){function a(a){var t=document.createElement("video");return t.canPlayType(a)?!0:!1}function t(a){var t="";return 0==a?t="wi-tornado":1==a||45==a?t="wi-storm-showers":2==a?t="wi-lightning":3==a||4==a||47==a?t="wi-thunderstorm":5==a||46==a?t="wi-rain-mix":6==a||7==a||13==a||14==a||18==a||36==a?t="wi-sleet":8==a||9==a||10==a||11==a||12==a?t="wi-showers":15==a||41==a||42==a||43==a?t="wi-snow":16==a?t="wi-snow-wind":17==a?t="wi-hail":19==a?t="wi-dust":20==a?t="wi-fog":21==a?t="wi-day-haze":22==a?t="wi-smoke":23==a||24==a?t="wi-windy":25==a?t="wi-snowflake-cold":26==a?t="wi-cloud":27==a||29==a?t="wi-night-cloudy":28==a||30==a?t="wi-day-cloudy":31==a||33==a||44==a?t="wi-stars":32==a||34==a?t="wi-day-sunny":36==a?t="wi-hot":37==a||38==a||39==a?t="wi-thunderstorm":40==a?t="wi-showers":3200==a&&(t="wi-alien"),t}$("ul.tabs").tabs(),$("#current").hide(),$(".mapcontrol").hide(),$(".mapshare").hide(),$(".map-preloader").show(),$("select").material_select(),null===localStorage.getItem("weather")?(localStorage.weather="10001",localStorage.nimbus="2.1",$("#welcome").openModal()):"2.1"!=localStorage.getItem("nimbus")&&(localStorage.nimbus="2.1",$("#new").openModal()),null===localStorage.getItem("unit")&&(localStorage.unit="f"),null===localStorage.getItem("radar-location")&&(localStorage["radar-location"]=""),null===localStorage.getItem("radar-player")&&(localStorage["radar-player"]="true"),null===localStorage.getItem("color")?localStorage.color="#3ca2eb":"#13A38D"===localStorage.getItem("color")&&(localStorage.color="#3ca2eb"),null===localStorage.getItem("bg")&&(localStorage.bg=""),(null===localStorage.getItem("analytics")||"yes"===localStorage.getItem("analytics"))&&(localStorage.analytics="true"),$("#location").val(localStorage.weather),$("#unit").val(localStorage.unit),$("#radar-location").val(localStorage["radar-location"]),"true"===localStorage.getItem("radar-player")?$("#radar-player").prop("checked",!0):($("#radar-player").prop("checked",!1),a("video/webm")||a("video/mp4")||($("#radar-player").prop("disabled",!0),$("#radar-player").parent().parent().click(function(){Materialize.toast("HTML5 not supported!",3e3,"rounded")}))),$("#color").val(localStorage.color),$("#bg").val(localStorage.bg),$("#analytics").prop("checked",JSON.parse(localStorage.analytics)),"true"==localStorage.getItem("analytics")&&(!function(a,t,e,o,c,r,i){a.GoogleAnalyticsObject=c,a[c]=a[c]||function(){(a[c].q=a[c].q||[]).push(arguments)},a[c].l=1*new Date,r=t.createElement(e),i=t.getElementsByTagName(e)[0],r.async=1,r.src=o,i.parentNode.insertBefore(r,i)}(window,document,"script","http://www.google-analytics.com/analytics.js","ga"),ga("create","UA-59452245-1","auto"),ga("send","pageview")),localStorage.getItem("bg").length>0&&$(".content").css("background","url("+localStorage.getItem("bg")+") center no-repeat","important"),$("#tabs").css("background",localStorage.color,"important"),$(".tabs").css("background",localStorage.color,"important"),$(".tab a").css("background",localStorage.color,"important"),$(".credit").css("color",localStorage.color,"important"),$(".title").css("color",localStorage.color,"important"),$(".secondary-content").css("color",localStorage.color,"important"),$(".settings-save").css("background",localStorage.color,"important"),$(".mapcontrol").css("background",localStorage.color,"important"),$(".mapshare").css("background",localStorage.color,"important"),$(".btn").css("background",localStorage.color,"important"),$(".btn").css("background",localStorage.color,"important"),$(".spinner-layer").css("border-color",localStorage.color,"important"),$(document).on("click",".settings-trigger",function(){$("#settings").fadeIn("slow",function(){})}),$(".twitterlink").click(function(){window.open("https://twitter.com/NimbusWeather","_blank")}),$(".googlelink").click(function(){window.open("https://plus.google.com/107563170995027312930","_blank")}),$(".githublink").click(function(){window.open("https://github.com/corbindavenport/nimbus","_blank")}),$(".location-item").click(function(){$("#location-modal").openModal(),$("#location").select()}),$(".units-item").click(function(){$("#units-modal").openModal()}),$(".reset-item").click(function(){$("#reset-modal").openModal()}),$(".reset-confirm").click(function(){localStorage.weather="10001",localStorage.unit="f",localStorage["radar-quality"]="1",localStorage["radar-location"]="",localStorage["radar-player"]="true",localStorage.color="#3ca2eb",localStorage.bg="",localStorage.analytics="true",window.location.replace("index.html")}),$(".radar-location-item").click(function(){$("#radar-location-modal").openModal(),$("#radar-location").select()}),$(".hex-item").click(function(){$("#hex-modal").openModal(),$("#color").select()}),$(".picker-item").click(function(){$("#picker-modal").openModal()}),$(".color-reset").click(function(){document.getElementById("color").value="#3ca2eb",Materialize.toast("Color reset!",3e3,"rounded")}),$(".background-item").click(function(){$("#background-modal").openModal(),$("#bg").select()}),$(".privacy").click(function(){$("#privacymodal").openModal()}),$(".paypal").click(function(){$("#paypalmodal").openModal()}),$(".bitcoin").click(function(){$("#bitcoinmodal").openModal()}),$(".settings-save").click(function(){$("#location").val().length>"0"&&null!=$("#radar-location").val().match(/^\d+$/)||""===$("#radar-location").val()?(localStorage.weather=$("#location").val(),localStorage.unit=$("#unit").val(),localStorage["radar-location"]=$("#radar-location").val(),localStorage["radar-player"]=$("#radar-player").is(":checked")?"true":"false",localStorage.color=$("#color").val(),localStorage.bg=$("#bg").val(),localStorage.analytics=$("#analytics").is(":checked")?"true":"false",window.location.replace("index.html")):toast("Enter a valid location!",3e3,"rounded")});$.simpleWeather({location:localStorage.weather,woeid:"",unit:localStorage.unit,success:function(e){current='<div class="card"><div class="card-content"><span class="card-title">'+e.city+", "+e.region+'</span><table><tr><th class="weather-icon"><i class="wi '+t(e.code)+'"></i></th><th class="weather-info"><span class="temp">'+e.temp+"&deg;"+e.units.temp+"</span><br />"+e.high+"&deg;"+e.units.temp+" / "+e.low+"&deg;"+e.units.temp+'</th></tr></table><div class="weather-updated">Last updated '+e.updated+'</div></div></div><div class="card"><div class="card-content"><span class="card-title">Winds</span><p><b>Wind chill:</b> '+e.wind.chill+"&deg;"+e.units.temp+"<p><b>Speed:</b> "+e.wind.speed+" "+e.units.speed+" "+e.wind.direction+'</div></div><div class="card"><div class="card-content"><span class="card-title">Daylight</span><p><b>Sunrise:</b> '+e.sunrise+"</p><p><b>Sunset:</b> "+e.sunset+"</p><p><b>Visibility:</b> "+e.visibility+" "+e.units.distance+'</p></div></div><div class="card"><div class="card-content"><div class="row"><button type="submit" name="action" class="btn-flat col s12 m6" id="share-twitter">Share on Twitter<i class="mdi-content-send right"></i></button><button type="submit" name="action" class="btn-flat col s12 m6" id="share-tumblr">Share on Tumblr<i class="mdi-content-send right"></i></button></div></div></div><div class="card"><a class="btn-flat btn-large waves-effect settings-trigger" href="#">Open Settings</a></div>',$("#current").append(current),forecast='<div id="forecast-container"><div class="card forecast1"><div class="card-content"><span class="card-title">Forecast on '+e.forecast[0].day+'</span><table><tr><th class="forecast-icon"><i class="wi '+t(e.forecast[0].code)+'"></i></th><th class="forecast-info"><span class="temp">'+e.forecast[0].high+"&deg;"+e.units.temp+" / "+e.forecast[0].low+"&deg;"+e.units.temp+"</span><br />"+e.forecast[0].text+'</th></tr></table></div></div><div class="card forecast2"><div class="card-content"><span class="card-title">Forecast on '+e.forecast[1].day+'</span><table><tr><th class="forecast-icon"><i class="wi '+t(e.forecast[1].code)+'"></i></th><th class="forecast-info"><span class="temp">'+e.forecast[1].high+"&deg;"+e.units.temp+" / "+e.forecast[1].low+"&deg;"+e.units.temp+"</span><br />"+e.forecast[1].text+'</th></tr></table></div></div><div class="card forecast3"><div class="card-content"><span class="card-title">Forecast on '+e.forecast[2].day+'</span><table><tr><th class="forecast-icon"><i class="wi '+t(e.forecast[2].code)+'"></i></th><th class="forecast-info"><span class="temp">'+e.forecast[2].high+"&deg;"+e.units.temp+" / "+e.forecast[2].low+"&deg;"+e.units.temp+"</span><br />"+e.forecast[2].text+'</th></tr></table></div></div><div class="card forecast4"><div class="card-content"><span class="card-title">Forecast on '+e.forecast[3].day+'</span><table><tr><th class="forecast-icon"><i class="wi '+t(e.forecast[3].code)+'"></i></th><th class="forecast-info"><span class="temp">'+e.forecast[3].high+"&deg;"+e.units.temp+" / "+e.forecast[3].low+"&deg;"+e.units.temp+"</span><br />"+e.forecast[3].text+'</th></tr></table></div></div><div class="card forecast5"><div class="card-content"><span class="card-title">Forecast on '+e.forecast[4].day+'</span><table><tr><th class="forecast-icon"><i class="wi '+t(e.forecast[4].code)+'"></i></th><th class="forecast-info"><span class="temp">'+e.forecast[4].high+"&deg;"+e.units.temp+" / "+e.forecast[4].low+"&deg;"+e.units.temp+"</span><br />"+e.forecast[4].text+"</th></tr></table></div></div></div>",$("#forecast").append(forecast);var o="It's currently "+e.temp+"Â°"+e.units.temp+" and "+e.currently+" in "+e.city+" right now!";if($("#share-twitter").click(function(){window.open("https://twitter.com/intent/tweet?via=NimbusWeather&text="+encodeURIComponent(o),"Twitter","width=500,height=300,scrollbars=0")}),$("#share-tumblr").click(function(){window.open("https://www.tumblr.com/share?s=&v=3&t="+encodeURIComponent(o),"Tumblr","width=500,height=300,scrollbars=0")}),"United States"===e.country)if(""!==localStorage.getItem("radar-location")){var c="http://www.tephigram.weather.net/cgi-bin/razradar.cgi?zipcode="+localStorage["radar-location"];if("true"===localStorage.getItem("radar-player")&&(a("video/webm")||a("video/mp4"))){$(".forecast-trigger").click(function(){$(".mapcontrol").hide(),$(".mapshare").hide()}),$(".current-trigger").click(function(){$(".mapcontrol").hide(),$(".mapshare").hide()}),$(".map-trigger").click(function(){$(".mapcontrol").show(),$(".mapshare").show()});var r=new Date,i="http://upload.gfycat.com/transcode?fetchUrl="+encodeURIComponent(c+"&width="+$("#map").width()+"&height="+$("#map").height()+".gif&time="+r.getMonth()+r.getDate()+r.getFullYear()+r.getHours());$("#map").prepend('<div class="toast map-toast">Requesting map...</div>'),$.getJSON(i,function(a){if(null!=a.error)$(".map-toast").fadeOut("slow",function(){}),$("#map").append('<div class="card"><div class="card-content"><span class="card-title">Gfycat API Error</span><p>Gfycat was unable to load the radar map, and reported this error:</p><p class="error">'+a.error+'</p><p>You can try reopening Nimbus, or switching "New radar player" to off in the settings.</div></div><div class="card"><a class="btn-flat btn-large waves-effect settings-trigger" href="#">Open Settings</a></div>');else{$(".map-toast").html("Downloading map..."),$("#map").append('<video id="mapvideo" muted="true" loop="true" webkit-playsinline><source src="http://zippy.gfycat.com/'+a.gfyName+'.webm" type="video/webm"><source src="http://zippy.gfycat.com/'+a.gfyName+'.mp4" type="video/mp4"></video>');var t=document.getElementById("mapvideo");$("#mapvideo").hide(),$("#mapvideo").on("loadedmetadata",function(){$(".map-toast").html("Map loaded!"),$(".map-toast").fadeOut("slow",function(){}),$(".map-preloader").fadeOut("slow",function(){}),$("#mapvideo").show(),$(".mapcontrol").html('<i class="mdi-av-play-arrow"></i>'),$(".mapshare").click(function(){$("#shareurl").attr("value","http://gfycat.com/"+a.gfyName),$(".sharelink").attr("href","http://gfycat.com/"+a.gfyName),$("#share-modal").openModal(),$("#shareurl").select()}),$(".mapcontrol").click(function(){t.paused?($(".mapcontrol").html('<i class="mdi-av-pause"></i>'),t.play()):($(".mapcontrol").html('<i class="mdi-av-play-arrow"></i>'),t.pause())})})}})}else $(".forecast-trigger").click(function(){$(".mapshare").hide()}),$(".current-trigger").click(function(){$(".mapshare").hide()}),$(".map-trigger").click(function(){$(".mapshare").show()}),$(".mapshare").css("bottom","16px"),$(window).load(function(){$("#map").append('<img id="mapgif" src="'+c+"&width="+$("#map").width()+"&height="+$("#map").height()+'" >'),$("#mapgif").hide(),$("#map").prepend('<div class="toast map-toast">Loading GIF...</div>'),$("#mapgif").load(function(){$(".map-toast").html("Map loaded!"),$("#mapgif").fadeIn("slow",function(){$(".map-preloader").fadeOut("slow",function(){}),$(".map-toast").fadeOut("slow",function(){})})})}),$(".mapshare").click(function(){$("#shareurl").attr("value",c+"&width=500&height=500"),$(".sharelink").attr("href",c+"&width=500&height=500"),$("#share-modal").openModal(),$("#shareurl").select()})}else $("#map").html('<div class="card"><div class="card-content"><span class="card-title">Map not configured</span><p>Due to an API limitation, you need to configure the location for the radar map seperately. Go to the settings and set a radar location.</p></div></div><div class="card"><a class="btn-flat btn-large waves-effect settings-trigger" href="#">Open Settings</a></div>');else $("#map").html('<div class="card"><div class="card-content"><span class="card-title">Map unavailable</span><p>Due to an API limitation, radar maps are not available for locations outside the United States. This is being worked on, and may be available in a future update.</p></div></div>')},error:function(){$("#current").html('<div class="card"><div class="card-content"><span class="card-title">Error</span><p>There was an error loading the weather.</p></div><div class="card-action"><a href="javascript:window.location.replace('+index+');">Try again</a></div></div><div class="card"><a class="btn-flat btn-large waves-effect settings-trigger" href="#">Open Settings</a></div>'),$("#forecast").html('<div class="card"><div class="card-content"><span class="card-title">Error</span><p>There was an error loading the forecast.</p></div><div class="card-action"><a href="javascript:window.location.replace('+index+');">Try again</a></div></div><div class="card"><a class="btn-flat btn-large waves-effect settings-trigger" href="#">Open Settings</a></div>'),$("#map").html('<div class="card"><div class="card-content"><span class="card-title">Error</span><p>There was an error loading the radar map.</p></div><div class="card-action"><a href="javascript:window.location.replace('+index+');">Try again</a></div></div><div class="card"><a class="btn-flat btn-large waves-effect settings-trigger" href="#">Open Settings</a></div>')}})}),$(window).load(function(){$(".nimbus-preloader").fadeOut("slow",function(){}),$("#current").fadeIn("slow",function(){}),$("#settings-trigger").fadeIn("slow",function(){}),$("#colorpicker").farbtastic("#color")});